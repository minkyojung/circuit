/**
 * Circuit Design System - Main Stylesheet
 * Import order matters: tokens → Tailwind → components
 */

/* Design tokens (colors, spacing, typography) */
@import './design-tokens.css';

/* Tailwind layers */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* ===== BASE STYLES ===== */
@layer base {
  /* Default typography */
  * {
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro", "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    font-weight: var(--font-medium);
  }

  /* Body defaults */
  body {
    @apply text-foreground;
    color: var(--foreground);
    font-size: var(--font-base);
    line-height: var(--leading-normal);
    background-color: transparent;
  }

  /* Force transparency for peek panel (Electron specific) */
  html.peek-panel,
  html.peek-panel body,
  html.peek-panel #root {
    background-color: transparent !important;
    background: transparent !important;
  }

  /* Border color utility */
  * {
    @apply border-border;
  }
}

/* ===== COMPONENT LAYER ===== */
@layer components {
  /* Sidebar layout fixes */
  .group\/sidebar-wrapper:has([data-state="collapsed"][data-variant="inset"]) {
    @apply bg-sidebar;
  }

  /* Toast Glassmorphism Styling */
  [data-sonner-toast] {
    backdrop-filter: blur(12px) !important;
    -webkit-backdrop-filter: blur(12px) !important;
    background: var(--material-regular) !important;
    border: 1px solid var(--separator-opaque) !important;
    box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.1),
                0 4px 8px 0 rgba(0, 0, 0, 0.08) !important;
    color: var(--label-primary) !important;
  }

  /* Toast success variant */
  [data-sonner-toast][data-type="success"] {
    background: rgba(34, 197, 94, 0.15) !important;
    backdrop-filter: blur(12px) !important;
    border: 1px solid rgba(34, 197, 94, 0.3) !important;
  }

  /* Toast error variant */
  [data-sonner-toast][data-type="error"] {
    background: rgba(239, 68, 68, 0.15) !important;
    backdrop-filter: blur(12px) !important;
    border: 1px solid rgba(239, 68, 68, 0.3) !important;
  }

  /* Toast icon */
  [data-sonner-toast] [data-icon] {
    color: var(--label-primary) !important;
  }

  /* Toast title */
  [data-sonner-toast] [data-title] {
    color: var(--label-primary) !important;
    font-weight: var(--font-medium);
  }

  /* Toast description */
  [data-sonner-toast] [data-description] {
    color: var(--label-secondary) !important;
  }

  /* Toast close button */
  [data-sonner-toast] [data-close-button] {
    background: var(--fill-tertiary) !important;
    border: 1px solid var(--separator-translucent) !important;
    color: var(--label-secondary) !important;
  }

  [data-sonner-toast] [data-close-button]:hover {
    background: var(--fill-secondary) !important;
    color: var(--label-primary) !important;
  }

  [data-state="collapsed"][data-variant="inset"] ~ main {
    margin-left: 0;
  }

  /* Hide scrollbars */
  * {
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE and Edge */
  }

  *::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
  }

  /* Electron app region (macOS traffic lights) */
  [data-webkit-app-region="drag"] {
    -webkit-app-region: drag;
    user-select: none;
  }

  [data-webkit-app-region="no-drag"] {
    -webkit-app-region: no-drag;
  }

  /* Typography utilities */
  .text-xs { font-size: var(--font-xs); }
  .text-sm { font-size: var(--font-sm); }
  .text-base { font-size: var(--font-base); }
  .text-md { font-size: var(--font-md); }
  .text-lg { font-size: var(--font-lg); }
  .text-xl { font-size: var(--font-xl); }
  .text-2xl { font-size: var(--font-2xl); }
  .text-3xl { font-size: var(--font-3xl); }

  /* ===== FOCUS RING STYLES (Apple HIG) ===== */

  /* Base focus ring style */
  *:focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 2px;
    transition: outline-color var(--transition-fast), outline-offset var(--transition-fast);
  }

  /* Button focus styles */
  button:focus-visible,
  [role="button"]:focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 2px;
  }

  /* Input/textarea focus styles */
  input:focus-visible,
  textarea:focus-visible,
  select:focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 0px;
    border-color: transparent;
  }

  /* Link focus styles */
  a:focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 2px;
    border-radius: var(--radius-sm);
  }

  /* Interactive list item focus */
  [role="option"]:focus-visible,
  [role="menuitem"]:focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: -2px;
  }

  /* Remove default focus ring on click (only show for keyboard) */
  *:focus:not(:focus-visible) {
    outline: none;
  }

  /* ===== KEYBOARD NAVIGATION INDICATORS ===== */

  /* Show focus indicator when navigating with keyboard */
  .keyboard-nav *:focus {
    outline: 2px solid var(--ring);
    outline-offset: 2px;
  }

  /* Enhanced focus for command palette items */
  [data-command-item]:focus-visible {
    background-color: var(--sidebar-accent);
    outline: none;
  }

  /* Workspace item focus */
  [data-workspace-item]:focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: -2px;
    border-radius: var(--radius-md);
  }
}
